function hwp_model, lambda, epsilon_hwp = epsilon_hwp
  compile_opt idl2

  lambda_mm = lambda * 1e-06
  W_SiO2 = 1.623d
  W_MgF2 = 1.268d

  if n_elements(lambda) eq 22 then begin ; Using precomputed values for CHARIS broadband
    No_MgF2 = double([1.37264460186324, 1.37242217890004, 1.3721950699442604, 1.3719621982496155, 1.3717224594867308, 1.3714747161454446, 1.3712177917570674, 1.3709504649005464, 1.3706714629536383, 1.370379455549121, 1.3700730476930256, 1.3697507724980869, 1.3694110834841233, 1.3690523463906459, 1.3686728304441675, 1.368270699015774, 1.3678439995997282, 1.3673906530353213, 1.366908441887303, 1.3663949978894672, 1.3658477883469353, 1.3652641013782865])
    Ne_MgF2 = double([1.384198687268396, 1.3839628415351612, 1.3837218336935047, 1.383474521071655, 1.3832197307469136, 1.382956253598398, 1.3826828381620595, 1.382398184249572, 1.382100936289585, 1.3817896763486257, 1.3814629167856005, 1.381119092489746, 1.3807565526501837, 1.380373551998335, 1.3799682414613015, 1.37953865815685, 1.3790827146553932, 1.3785981874250786, 1.3780827043685924, 1.3775337313486054, 1.3769485575889246, 1.3763242798227924])

    No_SiO2 = double([1.532817938541442, 1.5322934166189457, 1.531754934215596, 1.531199788598694, 1.5306251760450662, 1.5300281741782964, 1.5294057231440228, 1.5287546054184482, 1.5280714240176634, 1.527352578848145, 1.5265942409020412, 1.525792323956521, 1.524942453390836, 1.524039931668601, 1.5230796999650995, 1.5220562953290564, 1.5209638026676928, 1.5197958007146606, 1.5185453009917602, 1.5172046785872932, 1.5157655933534087, 1.51421889984422])
    Ne_SiO2 = double([1.5415034516622548, 1.5409579239812228, 1.5403976973079714, 1.539819958217567, 1.5392217872099536, 1.5386001402848022, 1.537951829297335, 1.5372735008806506, 1.536561613691175, 1.5358124137052376, 1.5350219072561897, 1.5341858314549301, 1.5332996215887311, 1.5323583750238043, 1.531356811065872, 1.5302892261380394, 1.529149443529453, 1.527930756832346, 1.5266258660286436, 1.5252268049894229, 1.5237248589184071, 1.5221104699752577])
  endif else begin ; For non-broadband+low-res observations
    lambda_micron = lambda * 1d-03
    L2 = lambda_micron ^ 2d

    ; Coefficients from Ghosh et al. (1999):
    No_SiO2 = refractive_index(lambda_micron, 1.28604141d, 1.07044083d, 1.00585997d-2, 1.10202242d, 100d)
    Ne_SiO2 = refractive_index(lambda_micron, 1.28851804d, 1.09509924d, 1.02101864d-2, 1.15662475d, 100d)

    ; I can't find a copy of Dodge 1984, so just pulling the Sellmeier equation from https://refractiveindex.info/?shelf=main&book=MgF2&page=Dodge-o and https://refractiveindex.info/?shelf=main&book=MgF2&page=Dodge-e
    No_MgF2 = sqrt(1d + (0.48755108d * L2) / (L2 - 0.04338408d ^ 2d) + (0.39875031d * L2) / (L2 - 0.09461442d ^ 2) + (2.3120353d * L2) / (L2 - 23.793604d ^ 2d))
    Ne_MgF2 = sqrt(1d + (0.41344023d * L2) / (L2 - 0.03684262d ^ 2d) + (0.50497499d * L2) / (L2 - 0.09076162d ^ 2) + (2.4904862d * L2) / (L2 - 23.771995d ^ 2d))
  endelse

  dSiO2 = W_SiO2 * (Ne_SiO2 - No_SiO2)
  dMgF2 = W_MgF2 * (Ne_MgF2 - No_MgF2)
  delta_hwp = (2 * !dpi / lambda_mm) * (dMgF2 - dSiO2) ; Eq. 23 in Hart et al. 2021
  delta_hwp = delta_hwp * !radeg
  epsilon_hwp = 0.d ; Assumed ideal value via Hart et al. 2021
  return, delta_hwp
end